\documentclass[a4paper, 14 pt, titlepage]{extarticle}

\usepackage{grffile}
\usepackage{cmap}					% поиск в PDF
\usepackage[english,russian]{babel}	% локализация и переносы
\usepackage{indentfirst} 
\frenchspacing
\usepackage{setspace}
\usepackage{fontspec}      %% подготавливает загрузку шрифтов Open Type, True Type и др.
\defaultfontfeatures{Ligatures={TeX},Renderer=Basic}  %% свойства шрифтов по умолчанию
\setmainfont[Ligatures={TeX,Historic}]{Times New Roman} 
\setmonofont{Courier New}

\usepackage{amsmath,amsfonts,amssymb} 
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage{icomma}

\renewcommand{\epsilon}{\ensuremath{\varepsilon}}
\renewcommand{\phi}{\ensuremath{\varphi}}
\renewcommand{\kappa}{\ensuremath{\varkappa}}
\renewcommand{\le}{\ensuremath{\leqslant}}
\renewcommand{\leq}{\ensuremath{\leqslant}}
\renewcommand{\ge}{\ensuremath{\geqslant}}
\renewcommand{\geq}{\ensuremath{\geqslant}}
\renewcommand{\emptyset}{\varnothing}

\usepackage[unicode, pdfencoding=auto]{hyperref}
\usepackage[usenames,dvipsnames,svgnames,table,rgb]{xcolor}
\hypersetup{
            unicode=true,
            colorlinks=true,
            linkcolor=black,
            urlcolor=blue
           }

\usepackage{graphicx}
\graphicspath{{images/}}
\usepackage{wrapfig}
\usepackage{tikz}

\usepackage{array,tabularx,tabulary,booktabs, longtable, multirow}

\usepackage{etoolbox}
\usepackage{caption}
\captionsetup{labelsep=endash, font={singlespacing}, figurename=Рисунок }

\usepackage{fancyhdr} % Колонтитулы
 	\pagestyle{fancy}
 	\renewcommand{\headrulewidth}{0pt}  % Толщина линейки сверху
    \fancyfoot[R]{\thepage}
    \fancyfoot[C]{}
    \fancyhead[R]{}
    
\setstretch{1.5}

\usepackage{extsizes}
\usepackage{geometry}
\geometry{top=2cm}
\geometry{bottom=2cm}
\geometry{left=3cm}
\geometry{right=1.5cm}

\renewcommand{\thesection}{\Asbuk{section}}

\usepackage{titlesec}
\titleformat{\section}{\centering\normalsize\normalfont\bfseries}{}{0ex}{ПРИЛОЖЕНИЕ \thesection\\\uppercase}{}

\titleformat{\subsection}{\normalsize \normalfont \bfseries}{\thesubsection}{}{}
\titlespacing\subsection{1.25cm}{1cm}{0pt}

\parindent=1.25cm

\newcommand{\startcode}{
    \footnotesize
    \singlespacing
}

\newcommand{\finishcode}{\setstretch{1.5}\normalsize}

\newenvironment{code}{\startcode}{\finishcode}

\newcommand{\printcaption}[1]{
    \normalsize
    {
    \captionsetup{justification=raggedright, singlelinecheck=off}
    \caption{#1}
    }
}
